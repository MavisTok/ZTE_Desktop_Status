# 编译检查清单

## ✅ 已修复的问题

### 1. C# 语言版本问题
- ✅ 已添加 `<LangVersion>8.0</LangVersion>` 到项目文件
- 位置: `ZTE.csproj` 第 17 行

### 2. 可空引用类型问题
- ✅ 已移除 `object?` 中的 `?` 标记
- ✅ 已移除 `!` 非空断言运算符
- ✅ 已替换 `null` 默认参数为 `""`
- 修改文件:
  - `Api\UbusClient.cs`
  - `ViewModels\ViewModelBase.cs`

### 3. NuGet 包引用路径
- ✅ 已修正 HintPath 从 `..\packages\` 到 `packages\`
- ✅ 所有必需的 DLL 文件已存在

## 编译步骤

### 在 Visual Studio 中编译

1. **关闭并重新打开项目**
   - 如果项目已打开,请关闭 Visual Studio
   - 重新打开 `ZTE.csproj`

2. **清理解决方案**
   - 菜单: 生成 → 清理解决方案
   - 或右键项目 → 清理

3. **重新生成**
   - 菜单: 生成 → 重新生成解决方案
   - 或按 `Ctrl + Shift + B`

4. **检查输出**
   - 查看"输出"窗口
   - 应该看到 "生成成功"

### 预期结果

编译成功后,应该看到类似输出:

```
1>------ 已启动生成: 项目: ZTE, 配置: Debug Any CPU ------
1>  ZTE -> E:\.NET Ly\ZTE\bin\Debug\ZTE.exe
========== 生成: 成功 1 个,失败 0 个,最新 0 个,跳过 0 个 ==========
```

## 验证编译结果

### 1. 检查输出文件

运行以下检查:
- [ ] `bin\Debug\ZTE.exe` 文件存在
- [ ] `bin\Debug\System.Text.Json.dll` 文件存在
- [ ] 文件大小合理 (ZTE.exe 应该约 20-50 KB)

### 2. 依赖 DLL 检查

确保以下 DLL 已复制到输出目录:

- [ ] System.Text.Json.dll
- [ ] System.Memory.dll
- [ ] System.Buffers.dll
- [ ] System.Runtime.CompilerServices.Unsafe.dll
- [ ] System.Text.Encodings.Web.dll
- [ ] System.Threading.Tasks.Extensions.dll
- [ ] System.Numerics.Vectors.dll
- [ ] System.ValueTuple.dll

### 3. 运行测试

**测试 1: 启动应用**
```
运行: bin\Debug\ZTE.exe
预期: 窗口打开,显示仪表盘
```

**测试 2: 检查错误消息**
```
如果显示初始化错误: 正常 (需要配置路由器地址)
如果显示 "Error: ..." : 需要更新 Session Token
如果无法启动: 检查 .NET Framework 版本
```

## 如果仍然有编译错误

### 错误: CS0234 "未找到 System.Text.Json"

**解决方案:**
```
1. 在 Visual Studio 中:
   - 工具 → NuGet 包管理器 → 程序包管理器控制台
   - 运行: Update-Package -reinstall

2. 或手动添加引用:
   - 右键项目 → 添加 → 引用
   - 浏览到: packages\System.Text.Json.8.0.0\lib\net462\
   - 选择 System.Text.Json.dll
```

### 错误: CS8370 "功能不可用"

**解决方案:**
```
1. 关闭 Visual Studio
2. 用文本编辑器打开 ZTE.csproj
3. 确认第 17 行有: <LangVersion>8.0</LangVersion>
4. 保存并重新打开项目
```

### 错误: 找不到 packages 文件夹

**解决方案:**
```
1. 右键解决方案 → "还原 NuGet 程序包"
2. 或在命令行运行:
   cd "E:\.NET Ly\ZTE"
   dotnet restore
```

## 配置运行环境

编译成功后,需要配置才能连接路由器:

### 1. 编辑 AppSettings.cs

```csharp
// 修改路由器地址 (第 13 行)
public static string RouterUrl { get; set; } = "http://192.168.0.1";

// 修改 Session Token (第 18 行)
public static string SessionToken { get; set; } = "你的session值";
```

### 2. 获取 Session Token

1. 浏览器访问: http://192.168.0.1
2. F12 → Network (网络) 标签
3. 刷新页面
4. 找到 `/ubus/` 请求
5. 查看 Payload,复制 session 值
6. 粘贴到 AppSettings.cs

### 3. 重新编译

修改配置后需要重新编译:
```
按 Ctrl + Shift + B
```

## 成功运行的标志

当一切正常时,你应该看到:

1. **窗口标题**: "ZTE Router Dashboard"
2. **状态栏**: 显示绿色圆点和 "Connected"
3. **数据刷新**: 每 2 秒更新一次
4. **6 个卡片**: 全部显示数据 (不是 N/A)

## 下一步

✅ 编译成功后,查看:
- `README.md` - 完整使用说明
- `项目规划\项目实现总结.md` - 功能说明

## 需要帮助?

如果遇到其他问题:

1. 检查错误消息的具体内容
2. 确认 .NET Framework 4.7.2 已安装
3. 尝试清理并重新生成
4. 检查所有文件是否正确保存

---

**最后更新**: 2026-01-08
**状态**: ✅ 所有已知问题已修复
