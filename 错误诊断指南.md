# ZTE Router Dashboard - é”™è¯¯è¯Šæ–­æŒ‡å—

## ğŸ” å¦‚ä½•æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

### æ–¹æ³• 1: åº•éƒ¨çŠ¶æ€æ  (æ¨è)
åº”ç”¨åº•éƒ¨çš„çŠ¶æ€æ ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œæ ¼å¼ä¸ºï¼š
```
â— Status: Error: [é”™è¯¯ç±»å‹] - [é”™è¯¯æ¶ˆæ¯] | Inner: [å†…éƒ¨é”™è¯¯]
```

### æ–¹æ³• 2: Visual Studio è¾“å‡ºçª—å£
åœ¨ Visual Studio ä¸­è¿è¡Œæ—¶ï¼Œè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ä¼šè¾“å‡ºåˆ°"è¾“å‡º"çª—å£ï¼š

1. è¿è¡Œåº”ç”¨ (F5)
2. èœå•: è§†å›¾ â†’ è¾“å‡º (æˆ– Ctrl + Alt + O)
3. åœ¨"æ˜¾ç¤ºè¾“å‡ºæ¥æº"ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©"è°ƒè¯•"
4. æŸ¥çœ‹è¯¦ç»†çš„é”™è¯¯å †æ ˆè·Ÿè¸ª

è¾“å‡ºæ ¼å¼ï¼š
```
=== Dashboard Refresh Error ===
Type: System.ObjectDisposedException
Message: æ— æ³•è®¿é—®å·²é‡Šæ”¾çš„å¯¹è±¡ã€‚å¯¹è±¡å:"JsonDocument"ã€‚
StackTrace: [å®Œæ•´å †æ ˆè·Ÿè¸ª]
Inner Exception: [å†…éƒ¨å¼‚å¸¸ç±»å‹]
Inner Message: [å†…éƒ¨å¼‚å¸¸æ¶ˆæ¯]
===============================
```

## ğŸ“‹ å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

### 1. ObjectDisposedException: æ— æ³•è®¿é—®å·²é‡Šæ”¾çš„å¯¹è±¡

**å®Œæ•´é”™è¯¯**:
```
Error: ObjectDisposedException - æ— æ³•è®¿é—®å·²é‡Šæ”¾çš„å¯¹è±¡ã€‚å¯¹è±¡å:"JsonDocument"ã€‚
```

**åŸå› **: JsonDocument ç”Ÿå‘½å‘¨æœŸç®¡ç†é—®é¢˜ï¼ˆå·²åœ¨ v1.1.1 ä¿®å¤ï¼‰

**è§£å†³æ–¹æ¡ˆ**:
```
1. ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ä»£ç 
2. æ£€æŸ¥ UbusClient.cs æ˜¯å¦åŒ…å« JsonElement å…‹éš†é€»è¾‘
3. é‡æ–°ç¼–è¯‘é¡¹ç›® (Ctrl + Shift + B)
```

**éªŒè¯ä¿®å¤**:
æŸ¥çœ‹ `Api\UbusClient.cs` ç¬¬ 111 è¡Œåº”è¯¥æœ‰ï¼š
```csharp
var clonedPayload = JsonDocument.Parse(payload.GetRawText()).RootElement;
```

---

### 2. HttpRequestException: ç½‘ç»œé”™è¯¯

**é”™è¯¯ç¤ºä¾‹**:
```
Network Error: No connection could be made because the target machine actively refused it
```

**åŸå› **: æ— æ³•è¿æ¥åˆ°è·¯ç”±å™¨

**è§£å†³æ–¹æ¡ˆ**:
```
1. æ£€æŸ¥è·¯ç”±å™¨æ˜¯å¦å¼€æœº
2. æ£€æŸ¥è·¯ç”±å™¨ IP åœ°å€æ˜¯å¦æ­£ç¡®
   - ç¼–è¾‘ AppSettings.cs ç¬¬ 11 è¡Œ
   - é»˜è®¤æ˜¯ http://192.168.0.1
3. å°è¯•åœ¨æµè§ˆå™¨è®¿é—®è·¯ç”±å™¨ç®¡ç†é¡µé¢
4. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
5. å°è¯• ping è·¯ç”±å™¨åœ°å€
```

**è¯Šæ–­å‘½ä»¤**:
```cmd
ping 192.168.0.1
```

---

### 3. JsonException: JSON è§£æé”™è¯¯

**é”™è¯¯ç¤ºä¾‹**:
```
JSON Parse Error: The JSON value could not be converted to [...] | Path: $.result[1]
```

**åŸå› **: API è¿”å›çš„æ•°æ®æ ¼å¼ä¸é¢„æœŸä¸ç¬¦

**è§£å†³æ–¹æ¡ˆ**:
```
1. æ£€æŸ¥è·¯ç”±å™¨å›ºä»¶ç‰ˆæœ¬æ˜¯å¦æ”¯æŒè¿™äº› API
2. æŸ¥çœ‹ Visual Studio è¾“å‡ºçª—å£çš„å®Œæ•´å“åº”
3. ç¡®è®¤ä½¿ç”¨çš„æ˜¯å…ç™»å½•æ¨¡å¼çš„ API
```

**è°ƒè¯•æ–¹æ³•**:
åœ¨ `UbusClient.cs` ç¬¬ 80 è¡Œåæ·»åŠ è°ƒè¯•è¾“å‡ºï¼š
```csharp
var respText = await resp.Content.ReadAsStringAsync().ConfigureAwait(false);
System.Diagnostics.Debug.WriteLine($"Response: {respText}");  // æ·»åŠ è¿™è¡Œ
```

---

### 4. TimeoutException: è¯·æ±‚è¶…æ—¶

**é”™è¯¯ç¤ºä¾‹**:
```
Error: TaskCanceledException - The request was canceled due to the configured HttpClient.Timeout
```

**åŸå› **: è·¯ç”±å™¨å“åº”å¤ªæ…¢æˆ–ç½‘ç»œå»¶è¿Ÿé«˜

**è§£å†³æ–¹æ¡ˆ**:
```
1. å¢åŠ è¶…æ—¶æ—¶é—´
   ç¼–è¾‘ AppSettings.cs ç¬¬ 26 è¡Œ:
   public static int RequestTimeoutSeconds { get; set; } = 10;  // æ”¹ä¸º 10 ç§’

2. æ£€æŸ¥ç½‘ç»œè¿æ¥è´¨é‡
3. ç¡®è®¤è·¯ç”±å™¨è¿è¡Œæ­£å¸¸
```

---

### 5. æ•°æ®æ˜¾ç¤º "N/A"

**çŠ¶æ€æ **: Status: Connected (è¿æ¥æˆåŠŸä½†æ²¡æ•°æ®)

**åŸå› **: API è¿”å›ç©ºæ•°æ®æˆ–æ•°æ®æ ¼å¼ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**:
```
1. æŸ¥çœ‹ Visual Studio è¾“å‡ºçª—å£çš„å®Œæ•´å“åº”
2. æ£€æŸ¥æ¨¡å‹ç±»å­—æ®µåæ˜¯å¦ä¸ API è¿”å›åŒ¹é…
3. ç¡®è®¤è·¯ç”±å™¨å‹å·æ˜¯å¦æ”¯æŒè¿™äº› API
```

**è°ƒè¯•æ­¥éª¤**:
1. åœ¨ `HomeDashboardService.cs` æ·»åŠ è°ƒè¯•è¾“å‡ºï¼š
```csharp
if (results.ContainsKey(2))
{
    var json = results[2].GetRawText();
    System.Diagnostics.Debug.WriteLine($"SIM Info: {json}");
    data.SimInfo = JsonSerializer.Deserialize<SimInfo>(json);
}
```

2. è¿è¡Œåº”ç”¨ï¼ŒæŸ¥çœ‹è¾“å‡ºçª—å£
3. å¯¹æ¯”è¿”å›çš„ JSON å­—æ®µåä¸æ¨¡å‹ç±»

---

### 6. åˆå§‹åŒ–å¤±è´¥

**å®Œæ•´é”™è¯¯**:
```
Failed to initialize application: [é”™è¯¯æ¶ˆæ¯]
```

**åŸå› **: åº”ç”¨å¯åŠ¨æ—¶å‡ºé”™

**è§£å†³æ–¹æ¡ˆ**:
```
1. æ£€æŸ¥ AppSettings.cs é…ç½®æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤è·¯ç”±å™¨åœ°å€æ ¼å¼: http://192.168.0.1 (åŒ…å« http://)
3. æ£€æŸ¥ Session Token æ˜¯å¦ä¸º 32 ä¸ª 0
4. æŸ¥çœ‹é”™è¯¯å¯¹è¯æ¡†çš„è¯¦ç»†æ¶ˆæ¯
```

---

## ğŸ› ï¸ é«˜çº§è¯Šæ–­

### å¯ç”¨è¯¦ç»†æ—¥å¿—

åœ¨ `DashboardViewModel.cs` çš„ `RefreshDataAsync` æ–¹æ³•å¼€å¤´æ·»åŠ ï¼š

```csharp
private async Task RefreshDataAsync()
{
    try
    {
        System.Diagnostics.Debug.WriteLine($"[{DateTime.Now:HH:mm:ss}] Starting refresh...");
        StatusMessage = "Connecting...";
        var data = await _dashboardService.FetchDashboardDataAsync();
        System.Diagnostics.Debug.WriteLine($"[{DateTime.Now:HH:mm:ss}] Refresh completed successfully");
        // ...
```

### æŠ“åŒ…åˆ†æ

ä½¿ç”¨ Fiddler æˆ– Wireshark æŠ“å– HTTP è¯·æ±‚ï¼š

1. å®‰è£… Fiddler Classic
2. å¯åŠ¨ Fiddler
3. è¿è¡Œ ZTE Router Dashboard
4. åœ¨ Fiddler ä¸­æŸ¥çœ‹ `/ubus/` è¯·æ±‚å’Œå“åº”
5. å¯¹æ¯”è¯·æ±‚æ ¼å¼æ˜¯å¦æ­£ç¡®

### å¯¹æ¯”æµè§ˆå™¨è¡Œä¸º

1. æµè§ˆå™¨æ‰“å¼€ http://192.168.0.1
2. F12 â†’ Network æ ‡ç­¾
3. åˆ·æ–°é¡µé¢
4. æ‰¾åˆ° `/ubus/` è¯·æ±‚
5. å¯¹æ¯” Payload å’Œ Response ä¸åº”ç”¨çš„å·®å¼‚

---

## ğŸ“ æŠ¥å‘Šé—®é¢˜

å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½æ— æ³•è§£å†³ï¼Œè¯·æ”¶é›†ä»¥ä¸‹ä¿¡æ¯ï¼š

### å¿…éœ€ä¿¡æ¯

1. **é”™è¯¯æ¶ˆæ¯**
   - åº•éƒ¨çŠ¶æ€æ æ˜¾ç¤ºçš„å®Œæ•´é”™è¯¯
   - Visual Studio è¾“å‡ºçª—å£çš„é”™è¯¯å †æ ˆ

2. **ç¯å¢ƒä¿¡æ¯**
   ```
   - è·¯ç”±å™¨å‹å·: [å¦‚ ZTE MC801A]
   - å›ºä»¶ç‰ˆæœ¬: [æŸ¥çœ‹è·¯ç”±å™¨ç®¡ç†é¡µé¢]
   - Windows ç‰ˆæœ¬: [å¦‚ Windows 10]
   - .NET Framework ç‰ˆæœ¬: [4.7.2]
   ```

3. **é…ç½®ä¿¡æ¯**
   ```
   - è·¯ç”±å™¨åœ°å€: [AppSettings.cs ç¬¬ 11 è¡Œ]
   - Session Token: [æ˜¯å¦ä½¿ç”¨å…ç™»å½•æ¨¡å¼]
   - è¶…æ—¶è®¾ç½®: [AppSettings.cs ç¬¬ 26 è¡Œ]
   ```

4. **API å“åº”**
   - æµè§ˆå™¨ F12 æŠ“å–çš„å®Œæ•´ ubus å“åº”
   - æˆ– Fiddler æŠ“å–çš„è¯·æ±‚/å“åº”

### å¯é€‰ä¿¡æ¯

- å±å¹•æˆªå›¾ï¼ˆåŒ…å«é”™è¯¯ä¿¡æ¯ï¼‰
- å®Œæ•´çš„å †æ ˆè·Ÿè¸ª
- ç‰¹æ®Šçš„ç½‘ç»œç¯å¢ƒï¼ˆå¦‚å…¬å¸ç½‘ç»œã€VPNç­‰ï¼‰

---

## ğŸ”§ é¢„é˜²æ€§æ£€æŸ¥æ¸…å•

åœ¨æŠ¥å‘Šé—®é¢˜å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ä»£ç 
- [ ] å·²è¿˜åŸæ‰€æœ‰ NuGet åŒ…
- [ ] å·²æ¸…ç†å¹¶é‡æ–°ç”Ÿæˆè§£å†³æ–¹æ¡ˆ
- [ ] è·¯ç”±å™¨åœ°å€æ­£ç¡®ä¸”å¯è®¿é—®
- [ ] Session Token ä¸º 32 ä¸ª 0 (å…ç™»å½•æ¨¡å¼)
- [ ] é˜²ç«å¢™æœªé˜»æ­¢åº”ç”¨
- [ ] åœ¨æµè§ˆå™¨ä¸­å¯ä»¥æ­£å¸¸è®¿é—®è·¯ç”±å™¨ç®¡ç†é¡µé¢
- [ ] æŸ¥çœ‹äº† Visual Studio è¾“å‡ºçª—å£çš„å®Œæ•´é”™è¯¯ä¿¡æ¯

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **å…ç™»å½•æ¨¡å¼è¯´æ˜.md** - äº†è§£å…ç™»å½•åŠŸèƒ½
- **å¿«é€Ÿå¼€å§‹.txt** - åŸºæœ¬ä½¿ç”¨æŒ‡å—
- **ç¼–è¯‘æŒ‡å—.md** - ç¼–è¯‘é—®é¢˜æ’æŸ¥
- **æ›´æ–°è¯´æ˜.md** - ç‰ˆæœ¬æ›´æ–°å†…å®¹

---

**æœ€åæ›´æ–°**: 2026-01-08
**ç‰ˆæœ¬**: v1.1.1
**çŠ¶æ€**: âœ… ObjectDisposedException å·²ä¿®å¤
